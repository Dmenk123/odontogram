var get_data=$("#get_data").val();function editDropResize(a){start=a.start.format("YYYY-MM-DD HH:mm:ss"),end=a.end?a.end.format("YYYY-MM-DD HH:mm:ss"):start,$.ajax({url:base_url+"jadwal_dokter/save",type:"POST",data:"calendar_id="+a.id+"&title="+a.title+"&start_date="+start+"&end_date="+end,dataType:"JSON",beforeSend:function(){},success:function(a){a.status?$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html("Data success update"):$(".notification").removeClass("alert-primary").addClass("alert-danger").find("p").html("Data cant update")},error:function(a,e,t){$(".notification").removeClass("alert-primary").addClass("alert-danger").find("p").html("Wrong server, please save again")}})}function save(){$("#form_create").submit(function(){var e,n=$(this);return $.ajax({url:base_url+"jadwal_dokter/save",type:n.attr("method"),data:n.serialize(),dataType:"JSON",beforeSend:function(){n.find("button[type=submit]").html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>')},success:function(a){a.status?(e={id:a.id,title:a.id_dokter,description:"",start:moment(a.tanggal),end:moment(a.tanggal),color:$("#create_modal select[name=color]").val()},$("#calendarIO").fullCalendar("renderEvent",e,!0),$("#create_modal").modal("hide"),n[0].reset(),$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html(a.notif)):(n.find(".alert").css("display","block"),n.find(".alert").html(a.notif)),n.find("button[type=submit]").html("Submit")},error:function(a,e,t){n.find("button[type=submit]").html("Submit"),n.find(".alert").css("display","block"),n.find(".alert").html("Wrong server, please save again")}}),!1})}function deteil(e){$.ajax({url:base_url+"jadwal_dokter/edit_jadwal",type:"POST",dataType:"JSON",data:{id:e.id},success:function(a){$("#create_modal input[name=calendar_id]").val(e.id),$("#create_modal input[name=tanggal]").val(moment(a.old_data.tanggal).format("DD/MM/YYYY")),$("#create_modal input[name=id_dokter]").val(a.old_data.id_dokter),$("#create_modal select[name=color]").val(e.color),$('[name="jam_mulai"]').val(a.old_data.jam_mulai),$('[name="jam_akhir"]').val(a.old_data.jam_akhir),$("#create_modal .delete_calendar").show(),$("#create_modal").modal("show")},error:function(a,e,t){alert("Error get data from ajax")}})}function editData(e){$("#form_create").submit(function(){var n=$(this);return $.ajax({url:base_url+"jadwal_dokter/save",type:n.attr("method"),data:n.serialize(),dataType:"JSON",beforeSend:function(){n.find("button[type=submit]").html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>')},success:function(a){a.status?(e.title=a.id_dokter,e.description="",e.start=moment(a.tanggal),e.end=moment(a.tanggal),e.color=$("#create_modal select[name=color]").val(),$("#calendarIO").fullCalendar("updateEvent",e),$("#create_modal").modal("hide"),n[0].reset(),$("#create_modal input[name=calendar_id]").val(0),$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html(a.notif)):(n.find(".alert").css("display","block"),n.find(".alert").html(a.notif)),n.find("button[type=submit]").html("Submit")},error:function(a,e,t){n.find("button[type=submit]").html("Submit"),n.find(".alert").css("display","block"),n.find(".alert").html("Wrong server, please save again")}}),!1})}function deleteData(e){$("#create_modal .delete_calendar").click(function(){$.ajax({url:base_url+"jadwal_dokter/delete",type:"POST",data:"id="+e.id,dataType:"JSON",beforeSend:function(){},success:function(a){a.status?($("#calendarIO").fullCalendar("removeEvents",e._id),$("#create_modal").modal("hide"),$("#form_create")[0].reset(),$("#create_modal input[name=calendar_id]").val(0),$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html(a.notif)):($("#form_create").find(".alert").css("display","block"),$("#form_create").find(".alert").html(a.notif))},error:function(a,e,t){$("#form_create").find(".alert").css("display","block"),$("#form_create").find(".alert").html("Wrong server, please save again")}})})}$("#jam_mulai").timepicker({minuteStep:1,showSeconds:!1,showMeridian:!1,snapToStep:!0}),$("#jam_akhir").timepicker({minuteStep:1,showSeconds:!1,showMeridian:!1,snapToStep:!0}),$(document).ready(function(){console.log("tes "),console.log(get_data),$("#datepick").datepicker({format:"yyyy-mm-dd",startDate:"-3d"}),$("#calendarIO").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,basicWeek,basicDay"},defaultDate:moment().format("YYYY-MM-DD"),editable:!0,eventLimit:!0,selectable:!0,html:!0,selectHelper:!0,select:function(a,e){$("#create_modal input[name=tanggal]").val(moment(a).format("YYYY-MM-DD")),$("#create_modal").modal("show"),save(),$("#calendarIO").fullCalendar("unselect")},eventDrop:function(a,e,t){editDropResize(a)},eventResize:function(a,e,t,n){editDropResize(a)},eventClick:function(a,e){deteil(a),editData(a),deleteData(a)},events:JSON.parse(get_data)})}),$(document).on("click",".add_calendar",function(){$("#create_modal input[name=calendar_id]").val(0),$("#create_modal").modal("show")}),$(document).on("submit","#form_create",function(){var e,n=$(this);return $.ajax({url:base_url+"jadwal_dokter/save",type:n.attr("method"),data:n.serialize(),dataType:"JSON",beforeSend:function(){n.find("button[type=submit]").html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>')},success:function(a){a.status?(e={id:a.id,title:a.id_dokter,description:"",start:moment(a.tanggal),end:moment(a.tanggal),color:$("#create_modal select[name=color]").val()},$("#calendarIO").fullCalendar("renderEvent",e,!0),$("#create_modal").modal("hide"),n[0].reset(),$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html(a.notif)):(n.find(".alert").css("display","block"),n.find(".alert").html(a.notif)),n.find("button[type=submit]").html("Submit")},error:function(a,e,t){n.find("button[type=submit]").html("Submit"),n.find(".alert").css("display","block"),n.find(".alert").html("Wrong server, please save again")}}),!1});