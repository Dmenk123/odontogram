$(document).ready(function(){initOpsiDiagnosa()});const formPintasan=()=>{$("#modalPintasanDiagnosa").modal("show")},initOpsiDiagnosa=()=>{$("#diagnosa").data("select2")&&$("#diagnosa").select2("destroy"),$("#diagnosa").select2({tokenSeparators:[","," "],minimumInputLength:0,minimumResultsForSearch:5,ajax:{url:base_url+"master_diagnosa/get_select_diagnosa",dataType:"json",type:"GET",data:function(a){return{term:a.term}},processResults:function(a){return{results:$.map(a,function(a){return{text:a.text,id:a.id,kode:a.kode,html:a.html}})}}}})};function reloadFormDiagnosa(){$("#CssLoader").removeClass("hidden"),$.ajax({type:"post",url:base_url+"rekam_medik/load_form_diagnosa",data:{id_peg:id_peg,id_psn:id_psn,id_reg:id_reg},dataType:"json",success:function(a){$("#CssLoader").addClass("hidden"),$("#tabel_modal_diagnosa tbody").html(a.html)}})}function hapus_diagnosa_det(e){swalConfirmDelete.fire({title:"Hapus Data Diagnosa ?",text:"Data Akan dihapus ?",type:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus Data !",cancelButtonText:"Tidak, Batalkan!",reverseButtons:!0}).then(a=>{a.value?$.ajax({url:base_url+"rekam_medik/delete_data_diagnosa_det",type:"POST",dataType:"JSON",data:{id:e},success:function(a){swalConfirm.fire("Berhasil Hapus Data!",a.pesan,"success"),reloadFormDiagnosa()},error:function(a,e,s){Swal.fire("Terjadi Kesalahan")}}):a.dismiss===Swal.DismissReason.cancel&&swalConfirm.fire("Dibatalkan","Aksi Dibatalakan","error")})}function saveMasterDiagnosa(){var a=$("#form_master_diagnosa")[0];let e=new FormData(a);$("#btnSaveMasterDiagnosa").prop("disabled",!0),$("#btnSaveMasterDiagnosa").text("Menyimpan Data"),swalConfirm.fire({title:"Perhatian !!",text:"Apakah anda yakin menambah data ini ?",type:"warning",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",reverseButtons:!0}).then(a=>{a.value?$.ajax({type:"POST",enctype:"multipart/form-data",url:base_url+"master_diagnosa/add_data_diagnosa",data:e,dataType:"JSON",processData:!1,contentType:!1,cache:!1,timeout:6e5,success:function(a){if(a.status)swal.fire("Sukses!!","Aksi Berhasil","success"),$("#btnSaveMasterDiagnosa").prop("disabled",!1),$("#btnSaveMasterDiagnosa").text("Simpan"),reset_modal_form_diagnosa(),initOpsiDiagnosa(),$("#modalPintasanDiagnosa").modal("hide");else{for(var e=0;e<a.inputerror.length;e++)"jabatans"!=a.inputerror[e]?($('[name="'+a.inputerror[e]+'"]').addClass("is-invalid"),$('[name="'+a.inputerror[e]+'"]').next().text(a.error_string[e]).addClass("invalid-feedback")):$($("#jabatans").data("select2").$container).addClass("has-error");$("#btnSaveMasterDiagnosa").prop("disabled",!1),$("#btnSaveMasterDiagnosa").text("Simpan")}},error:function(a){console.log("ERROR : ",a),$("#btnSaveMasterDiagnosa").prop("disabled",!1),$("#btnSaveMasterDiagnosa").text("Simpan"),reset_modal_form_diagnosa(),$("#modalPintasanDiagnosa").modal("hide")}}):a.dismiss===Swal.DismissReason.cancel&&swalConfirm.fire("Dibatalkan","Aksi Dibatalakan","error")})}function reset_modal_form_diagnosa(){$("#form_master_diagnosa")[0].reset(),$(".append-opt").remove(),$("div.form-group").children().removeClass("is-invalid invalid-feedback"),$("span.help-block").text(""),$("#div_pass_lama").css("display","none")}