var get_data=$("#get_data").val();function editDropResize(e){start=e.start.format("YYYY-MM-DD HH:mm:ss"),end=e.end?e.end.format("YYYY-MM-DD HH:mm:ss"):start,$.ajax({url:base_url+"jadwal_dokter/save",type:"POST",data:"calendar_id="+e.id+"&title="+e.title+"&start_date="+start+"&end_date="+end,dataType:"JSON",beforeSend:function(){},success:function(e){e.status?$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html("Data success update"):$(".notification").removeClass("alert-primary").addClass("alert-danger").find("p").html("Data cant update")},error:function(e,a,t){$(".notification").removeClass("alert-primary").addClass("alert-danger").find("p").html("Wrong server, please save again")}})}function save(){$("#form_create").submit(function(){var a,n=$(this);return $.ajax({url:base_url+"jadwal_dokter/save",type:n.attr("method"),data:n.serialize(),dataType:"JSON",beforeSend:function(){n.find("button[type=submit]").html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>')},success:function(e){e.status?(a={id:e.id,title:e.id_dokter,description:"",start:moment(e.tanggal),end:moment(e.tanggal),color:$("#create_modal select[name=color]").val()},$("#calendarIO").fullCalendar("renderEvent",a,!0),$("#create_modal").modal("hide"),n[0].reset(),$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html(e.notif)):(n.find(".alert").css("display","block"),n.find(".alert").html(e.notif)),n.find("button[type=submit]").html("Submit")},error:function(e,a,t){n.find("button[type=submit]").html("Submit"),n.find(".alert").css("display","block"),n.find(".alert").html("Wrong server, please save again")}}),!1})}function deteil(a){$.ajax({url:base_url+"jadwal_dokter/edit_jadwal",type:"POST",dataType:"JSON",data:{id:a.id},success:function(e){$("#create_modal input[name=calendar_id]").val(a.id),$("#create_modal input[name=tanggal]").val(moment(e.old_data.tanggal).format("DD/MM/YYYY")),$("#create_modal input[name=id_dokter]").val(e.old_data.id_dokter),$("#create_modal select[name=color]").val(a.color),$('[name="jam_mulai"]').val(e.old_data.jam_mulai),$('[name="jam_akhir"]').val(e.old_data.jam_akhir),$("#create_modal .delete_calendar").show(),$("#create_modal").modal("show")},error:function(e,a,t){alert("Error get data from ajax")}})}function editData(a){$("#form_create").submit(function(){var n=$(this);return $.ajax({url:base_url+"jadwal_dokter/save",type:n.attr("method"),data:n.serialize(),dataType:"JSON",beforeSend:function(){n.find("button[type=submit]").html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>')},success:function(e){e.status?(a.title=e.id_dokter,a.description="",a.start=moment(e.tanggal),a.end=moment(e.tanggal),a.color=$("#create_modal select[name=color]").val(),$("#calendarIO").fullCalendar("updateEvent",a),$("#create_modal").modal("hide"),n[0].reset(),$("#create_modal input[name=calendar_id]").val(0),$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html(e.notif)):(n.find(".alert").css("display","block"),n.find(".alert").html(e.notif)),n.find("button[type=submit]").html("Submit")},error:function(e,a,t){n.find("button[type=submit]").html("Submit"),n.find(".alert").css("display","block"),n.find(".alert").html("Wrong server, please save again")}}),!1})}function add_schedule(){save_method="add",$("#modal_schedule").modal("show"),$("#modal_title").text("Buat Jadwal Praktik Dokter Baru")}function deleteData(a){$("#create_modal .delete_calendar").click(function(){$.ajax({url:base_url+"jadwal_dokter/delete",type:"POST",data:"id="+a.id,dataType:"JSON",beforeSend:function(){},success:function(e){e.status?($("#calendarIO").fullCalendar("removeEvents",a._id),$("#create_modal").modal("hide"),$("#form_create")[0].reset(),$("#create_modal input[name=calendar_id]").val(0),$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html(e.notif)):($("#form_create").find(".alert").css("display","block"),$("#form_create").find(".alert").html(e.notif))},error:function(e,a,t){$("#form_create").find(".alert").css("display","block"),$("#form_create").find(".alert").html("Wrong server, please save again")}})})}function reset_modal_form(){$("#form-schedule")[0].reset(),$(".append-opt").remove(),$("div.form-group").children().removeClass("is-invalid invalid-feedback"),$("span.help-block").text(""),$("#div_pass_lama").css("display","none")}$("#jam_mulai").timepicker({minuteStep:1,showSeconds:!1,showMeridian:!1,snapToStep:!0}),$("#jam_akhir").timepicker({minuteStep:1,showSeconds:!1,showMeridian:!1,snapToStep:!0}),$(document).ready(function(){console.log("tes "),console.log(get_data),$("#datepick").datepicker({format:"yyyy-mm-dd",startDate:"-3d"}),$(".add-more").click(function(){var e=$(".copy").html();$(".after-add-more").after(e)}),$("body").on("click",".remove",function(){$(this).parents(".control-group").remove()}),$("#calendarIO").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,basicWeek,basicDay"},defaultDate:moment().format("YYYY-MM-DD"),editable:!0,eventLimit:!0,selectable:!0,html:!0,selectHelper:!0,select:function(e,a){$("#create_modal input[name=tanggal]").val(moment(e).format("YYYY-MM-DD")),$("#create_modal").modal("show"),save(),$("#calendarIO").fullCalendar("unselect")},eventDrop:function(e,a,t){editDropResize(e)},eventResize:function(e,a,t,n){editDropResize(e)},eventClick:function(e,a){deteil(e),editData(e),deleteData(e)},events:JSON.parse(get_data)})}),$(document).on("click",".add_calendar",function(){$("#create_modal input[name=calendar_id]").val(0),$("#create_modal").modal("show")}),$(document).on("submit","#form_create",function(){var a,n=$(this);return $.ajax({url:base_url+"jadwal_dokter/save",type:n.attr("method"),data:n.serialize(),dataType:"JSON",beforeSend:function(){n.find("button[type=submit]").html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>')},success:function(e){e.status?(a={id:e.id,title:e.id_dokter,description:"",start:moment(e.tanggal),end:moment(e.tanggal),color:$("#create_modal select[name=color]").val()},$("#calendarIO").fullCalendar("renderEvent",a,!0),$("#create_modal").modal("hide"),n[0].reset(),$(".notification").removeClass("alert-danger").addClass("alert-primary").find("p").html(e.notif)):(n.find(".alert").css("display","block"),n.find(".alert").html(e.notif)),n.find("button[type=submit]").html("Submit")},error:function(e,a,t){n.find("button[type=submit]").html("Submit"),n.find(".alert").css("display","block"),n.find(".alert").html("Wrong server, please save again")}}),!1});