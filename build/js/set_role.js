var save_method,table;function add_menu(){reset_modal_form(),save_method="add",$("#modal_menu_form").modal("show"),$("#modal_title").text("Tambah Menu Baru");var a=base_url+"set_menu/get_parent_data";$.ajax({type:"GET",url:a,dataType:"JSON",processData:!1,contentType:!1,cache:!1,timeout:6e5,success:function(a){a.status&&a.data.forEach(function(a){$("#parent_menu").append("<option value = "+a.id+' class="append-opt">'+a.nama+"</option>")})}})}function edit_menu(a){reset_modal_form(),save_method="update",$.ajax({url:base_url+"set_menu/edit_menu",type:"POST",dataType:"JSON",data:{id:a},success:function(a){a.data_menu.forEach(function(a){$("#parent_menu").append("<option value = "+a.id+' class="append-opt">'+a.nama+"</option>")}),$('[name="id_menu"]').val(a.old_data.id),$('[name="nama_menu"]').val(a.old_data.nama),$('[name="judul_menu"]').val(a.old_data.judul),$('[name="link_menu"]').val(a.old_data.link),$('[name="icon_menu"]').val(a.old_data.icon),$('[name="tingkat_menu"]').val(a.old_data.tingkat),$('[name="urutan_menu"]').val(a.old_data.urutan),$('[name="aktif_menu"]').val(a.old_data.aktif),$('[name="add_button"]').val(a.old_data.add_button),$('[name="edit_button"]').val(a.old_data.edit_button),$('[name="delete_button"]').val(a.old_data.delete_button),$('[name="parent_menu"]').val(a.old_data.id_parent),$("#modal_menu_form").modal("show"),$("#modal_title").text("Edit Menu")},error:function(a,e,t){alert("Error get data from ajax")}})}function reload_table(){table.ajax.reload(null,!1)}function save(){var a,t="add"==save_method?(a=base_url+"set_menu/add_data_menu","Tambah Menu"):(a=base_url+"set_menu/update_data_menu","Edit Menu"),e=$("#form-menu")[0],e=new FormData(e);$("#btnSave").prop("disabled",!0),$("#btnSave").text("Menyimpan Data"),$.ajax({type:"POST",enctype:"multipart/form-data",url:a,data:e,dataType:"JSON",processData:!1,contentType:!1,cache:!1,timeout:6e5,success:function(a){if(a.status)swal.fire("Sukses!!","Aksi "+t+" Berhasil","success"),$("#btnSave").prop("disabled",!1),$("#btnSave").text("Simpan"),reset_modal_form(),$(".modal").modal("hide"),reload_table();else{for(var e=0;e<a.inputerror.length;e++)"jabatan"!=a.inputerror[e]?($('[name="'+a.inputerror[e]+'"]').addClass("is-invalid"),$('[name="'+a.inputerror[e]+'"]').next().text(a.error_string[e]).addClass("invalid-feedback")):$($("#jabatan").data("select2").$container).addClass("has-error");$("#btnSave").prop("disabled",!1),$("#btnSave").text("Simpan")}},error:function(a){console.log("ERROR : ",a),$("#btnSave").prop("disabled",!1),$("#btnSave").text("Simpan"),reset_modal_form(),$(".modal").modal("hide")}})}function reload_table(){table.ajax.reload(null,!1)}function reset_modal_form(){$("#form-menu")[0].reset(),$(".append-opt").remove(),$("div.form-group").children().removeClass("is-invalid invalid-feedback"),$("span.help-block").text("")}$(document).ready(function(){$("input.numberinput").bind("keypress",function(a){return 8==a.which||0==a.which||!(a.which<48||57<a.which)||46==a.which}),table=$("#tabel_role").DataTable({responsive:!0,searchDelay:500,processing:!0,serverSide:!0,ajax:{url:base_url+"set_role/list_role",type:"POST"},columnDefs:[{targets:[-1],orderable:!1}]}),$(".tombol-simpan").click(function(a){a.preventDefault();var e=$(this).parents("form");swalConfirm.fire({title:"Simpan Pengaturan Hak Akses User ?",text:"Apakah Anda Yakin ?",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",reverseButtons:!0}).then(a=>{a.value?e.submit():swalConfirm.fire("Dibatalkan","Aksi Dibatalakan","error")})}),$(document).on("click",".btn_edit_status",function(){var e=$(this).attr("id"),t=$(this).val();swalConfirm.fire({title:"Ubah Status Data Hak Akses ?",text:"Apakah Anda Yakin ?",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Ubah Status!",cancelButtonText:"Tidak, Batalkan!",reverseButtons:!0}).then(a=>{a.value?$.ajax({url:base_url+"set_role/edit_status_role/"+e,type:"POST",dataType:"JSON",data:{status:t},success:function(a){swalConfirm.fire("Berhasil Ubah Status Menu!",a.pesan,"success"),table.ajax.reload()},error:function(a,e,t){Swal.fire("Terjadi Kesalahan")}}):a.dismiss===Swal.DismissReason.cancel&&swalConfirm.fire("Dibatalkan","Aksi Dibatalakan","error")})}),$(".modal").on("hidden.bs.modal",function(){reset_modal_form()})});